## Общая информация

Репозиторий с финальным проектом по курсу "Модели и архитектуры программ и знаний" в СПбГУ на 4 курсе программы "Математическое обеспечение и администрирование информационных систем".

## Постановка задачи

Финальный проект
Код с данными (размещенными на Github) + подготовленный и представленный доклад с презентацией.

Условия проекта
Выбрать любой сайт (например, avito.ru, cian.ru, drom.ru, auto.ru, auction.ru и др. (кроме wolmar.ru))

Извлечь с выбранного сайта данные при помощи языка программирования Python 3. Полученные данные должны содержать как минимум по одному типу бинарных (например, продан товар или нет), категориальных (какого цвета машина, сколько комнат в квартире, из какого металла монета и т.д.), числовых/количественных (например сколько стоит, сколько лет и т.д.) признаков. Всего должно быть не менее 5000 записей.

Предобработать данные (удалить или заполнить пропуски, выявить ошибки в данных и т.д.). Визуализировать предобработанные данные различными способами (распределение признаков и зависимости между ними), при этом использовать минимум три признака, а также минимум три взаимодействия между признаками. В результате визуализации предложить минимум три гипотезы (например, какая связь между возрастом автомобиля (квартиры) и ценой).

Выбрать целевую переменную для предсказания и обучить минимум 3 модели машинного обучения (при помощи библиотеки scikit-learn); при обучении использовать подбор гиперпараметров, кросс-валидацию и актуальные метрики в соответствии с задачей предсказания.

Условия сдачи финального проекта: 

Проект (код + собранные данные) должен быть размещён в установленный срок (до 23:59 23.03.2023) в своём репозитории на Github с оформленным readme. Readme должен содержать условия и результаты проделанной работы. 

Презентация должна быть выложены вместе с финальным проектом на Github (ссылка размещается под этим постом) в установленные сроки. Кроме того, в презентации должен быть правильно оформлен титульный слайд (в начале презентации и в конце). Структура титульных слайдов подразумевает расположение следующих структурных элементов друг под другом: тема; ФИО полностью; группа; e-mail; дата выступления. Презентация должна иметь следующую структуру с нумерацией слайдов: введение (1–2 слайда), выдвигаемые гипотезы и их проверка на визуализации, подсчёт первичных описательных статистик (3–5+ слайдов). Доклад по презентации не должен выходить за рамки 3–5 минут. В случае отклонения от части правил возможно снижение оценки.

## Структура репозитория

Решение задачи представлено в файле solution.ipynb
В нём содержится 4 вкладки:
- Data Collection. Здесь -- код для сбора информации с сайта.
- Preparation. Здесь -- подготовка и предобработка данных.
- Visualization. Здесь -- графики и диаграммы, построенные по данным.
- ML. Здесь -- эксперименты с моделями машинного обучения для решения задачи предсказания цены автомобиля.

Данные представлены в файле data_raw.tsv
Презентация представлена в файле presentation.txt

## Решение задачи
Для сбора данных подошла библиотека requests без дополнительных модификаций. Однако, был предусмотрен механизм задержки в случае, если системы сайта будут блокировать сбор.  

Во время предобработки из данных были удалены все строки, в которых не хватало части данных, единицы измерения убраны из данных и добавлены в заголовки колонок, а также типы данных были преобразованы к правильным.  

Визуализация включает в себя подсчет описательных статистик (boxplot для цены), изучение распределения (countplot для типа автомобиля) и гипотезы о взаимосвязи признаков (например, года и пробега).  

Было проведено обучение 5 моделей машинного обучения. Лучший результат показали GradientBoosting из sklearn и CatBoostClassifier. Лучший результат по метрике R^2 составил **0.915**
